<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tarjeta de Puntuación - Villagolf</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root { --bg: #f3f4f6; --card: #ffffff; }
    html,body { height:100%; margin:0; }
    body {
      font-family: 'Inter', sans-serif;
      background:var(--bg);
      color:#111827;
    }
    .score-input {
      width: 52px;
      height: 40px;
      text-align:center;
      border-radius:.5rem;
      border:1px solid #e5e7eb;
      background: #f9fafb;
      font-weight:600;
    }
    .score-input::-webkit-outer-spin-button,
    .score-input::-webkit-inner-spin-button { -webkit-appearance:none; margin:0; }
    .table-wrapper {
      width:100%;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      touch-action: pan-y pan-x;
      background:var(--card);
      border-radius: .75rem;
      box-shadow: 0 6px 18px rgba(15,23,42,0.06);
    }
    table { border-collapse: collapse; width: max-content; min-width:100%; }
    th, td { padding: .6rem .75rem; white-space:nowrap; vertical-align:middle; border-bottom: 1px solid #e6e6e6; }
    thead th { background:#f3f4f6; font-size:.75rem; text-transform:uppercase; letter-spacing:.06em; color: #374151; }
    .sticky-col { position: sticky; left: 0; z-index: 20; background: var(--card); }
    .player-name { color: #0f172a; font-weight: 800; background: var(--card); }
    .out-in { background:#ecfeff; font-weight:700; color:#0f766e; }
    .grand-total { background:#ecfccb; font-weight:800; color:#166534; font-size:1.05rem; }
    .trophy { font-size:1.05rem; color: #f59e0b; margin-left:6px; vertical-align:middle; }
    @media (max-width:640px) {
      .score-input { width:44px; height:36px; font-size:0.95rem; }
      th, td { padding: .45rem .6rem; }
      h1 { font-size:1.35rem; }
    }
    .table-wrapper.dragging { cursor: grabbing; cursor: -webkit-grabbing; }
    .social-icons { display: flex; justify-content: center; gap: 10px; align-items: center; margin-top: 10px; }
    .social-icons svg { width: 20px; height: 20px; fill: #374151; }
  </style>
</head>
<body>

<div class="container mx-auto p-4 max-w-5xl">
  <header class="text-center mb-6">
    <h1 class="text-2xl md:text-3xl font-extrabold text-teal-600 uppercase">Tarjeta de Puntuación</h1>
    <p class="mt-1 text-sm font-semibold text-red-600">VILLAGOLF GOLFITO</p>
  </header>

  <!-- Setup -->
  <section id="setup-section" class="bg-white p-5 rounded-xl mb-6 shadow">
    <h2 class="text-lg font-semibold text-gray-700 mb-3">Configuración del Juego</h2>
    <div id="player-inputs" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 mb-4"></div>
    <div class="flex gap-3 flex-col sm:flex-row">
      <button id="start-game-btn" class="flex-1 bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg">Iniciar Juego</button>
      <button id="reset-setup-btn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg">Limpiar Nombres</button>
    </div>
    <p class="mt-3 text-sm text-gray-500">En móviles puedes deslizar la tabla con el dedo (arriba/abajo y derecha/izquierda).</p>
  </section>

  <!-- Scorecard -->
  <section id="scorecard-section" class="hidden mb-6">
    <div class="flex items-center justify-between mb-3 gap-4">
      <h2 class="text-lg font-semibold text-gray-700">Tarjeta de Puntuación</h2>
      <div class="flex gap-2">
        <button id="reset-game-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-3 rounded-lg">Nuevo Juego</button>
        <button id="end-game-btn" class="bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-3 rounded-lg">Finalizar y Ver Ganador</button>
      </div>
    </div>
    <div id="table-scroll" class="table-wrapper">
      <table id="score-table" class="min-w-full">
        <thead id="scorecard-head"></thead>
        <tbody id="scorecard-body"></tbody>
      </table>
    </div>
  </section>

  <!-- Results -->
  <section id="results-section" class="hidden bg-white p-5 rounded-xl shadow mb-6">
    <h2 class="text-lg font-semibold text-center mb-4">Resultados Finales</h2>
    <div class="table-wrapper">
      <table id="results-table" class="w-full">
        <thead>
          <tr>
            <th class="sticky-col font-semibold">Puesto</th>
            <th class="font-semibold text-left">Jugador</th>
            <th class="font-semibold">Puntaje</th>
          </tr>
        </thead>
        <tbody id="results-body"></tbody>
      </table>
    </div>
    <div class="social-icons">
      <span class="font-semibold">@villagolfmini</span>
      <!-- Instagram SVG -->
      <svg viewBox="0 0 24 24"><path d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2zm0 1.5A4.25 4.25 0 0 0 3.5 7.75v8.5A4.25 4.25 0 0 0 7.75 20.5h8.5a4.25 4.25 0 0 0 4.25-4.25v-8.5A4.25 4.25 0 0 0 16.25 3.5h-8.5zM12 7a5 5 0 1 1 0 10a5 5 0 0 1 0-10zm0 1.5a3.5 3.5 0 1 0 0 7a3.5 3.5 0 0 0 0-7zm5.5-.75a1 1 0 1 1-2 0a1 1 0 0 1 2 0z"/></svg>
      <!-- Facebook SVG -->
      <svg viewBox="0 0 24 24"><path d="M22 12a10 10 0 1 0-11.5 9.9v-7h-2v-2.9h2v-2.2c0-2 1.2-3.1 3-3.1c.9 0 1.8.1 1.8.1v2h-1c-1 0-1.3.6-1.3 1.2v1.9h2.2l-.4 2.9h-1.8v7A10 10 0 0 0 22 12z"/></svg>
    </div>
    <div class="mt-4 text-center">
      <button id="restart-btn" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-lg">Volver a Jugar</button>
    </div>
  </section>
</div>

<script>
(function(){
  const playerInputsContainer = document.getElementById('player-inputs');
  const startGameBtn = document.getElementById('start-game-btn');
  const resetSetupBtn = document.getElementById('reset-setup-btn');
  const setupSection = document.getElementById('setup-section');
  const scorecardSection = document.getElementById('scorecard-section');
  const scorecardHead = document.getElementById('scorecard-head');
  const scorecardBody = document.getElementById('scorecard-body');
  const resetGameBtn = document.getElementById('reset-game-btn');
  const endGameBtn = document.getElementById('end-game-btn');
  const resultsSection = document.getElementById('results-section');
  const resultsBody = document.getElementById('results-body');
  const restartBtn = document.getElementById('restart-btn');
  const tableScroll = document.getElementById('table-scroll');

  for (let i=1; i<=8; i++){
    const div = document.createElement('div');
    div.innerHTML = `
      <label class="block text-sm font-medium text-gray-700">Jugador ${i}</label>
      <input type="text" id="player${i}" placeholder="Nombre del Jugador ${i}" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md">
    `;
    playerInputsContainer.appendChild(div);
  }

  startGameBtn.addEventListener('click', () => {
    const players = [];
    for (let i=1; i<=8; i++){
      const val = document.getElementById(\`player\${i}\`).value.trim();
      if (val) players.push(val);
    }
    if (players.length === 0) return alert('Por favor ingresa al menos un jugador.');
    setupScorecard(players);
    setupSection.classList.add('hidden');
    scorecardSection.classList.remove('hidden');
  });

  resetSetupBtn.addEventListener('click', () => {
    for (let i=1; i<=8; i++) document.getElementById(\`player\${i}\`).value = '';
  });

  resetGameBtn.addEventListener('click', () => {
    if (!confirm('¿Iniciar un nuevo juego?')) return;
    location.reload();
  });

  restartBtn.addEventListener('click', () => location.reload());

  function setupScorecard(players){
    scorecardHead.innerHTML = '';
    scorecardBody.innerHTML = '';
    const trHead = document.createElement('tr');
    let headerHTML = '<th class="sticky-col">Jugador</th>';
    for (let i=1; i<=9; i++) headerHTML += \`<th>\${i}</th>\`;
    headerHTML += '<th class="out-in">OUT</th>';
    for (let i=10; i<=18; i++) headerHTML += \`<th>\${i}</th>\`;
    headerHTML += '<th class="out-in">IN</th><th class="grand-total">TOTAL</th>';
    trHead.innerHTML = headerHTML;
    scorecardHead.appendChild(trHead);

    players.forEach((name, idx) => {
      const tr = document.createElement('tr');
      tr.id = \`player-row-\${idx}\`;
      let rowHTML = \`<td class="sticky-col player-name" data-name="\${name}">\${name}</td>\`;
      for (let hole=1; hole<=18; hole++){
        rowHTML += \`<td><input type="number" min="0" max="20" class="score-input" data-player="\${idx}" data-hole="\${hole}"></td>\`;
      }
      rowHTML += \`<td id="out-total-\${idx}" class="out-in">0</td><td id="in-total-\${idx}" class="out-in">0</td><td id="grand-total-\${idx}" class="grand-total">0</td>\`;
      tr.innerHTML = rowHTML;
      scorecardBody.appendChild(tr);
    });
    scorecardBody.querySelectorAll('.score-input').forEach(inp => {
      inp.addEventListener('input', onScoreInput);
    });
    enableDragScroll(tableScroll);
  }

  function onScoreInput(e){
    const target = e.target;
    let v = parseInt(target.value) || 0;
    if (v < 0) v = 0;
    if (v > 20) v = 20;
    target.value = v;
    updateScoresForPlayer(target.dataset.player);
  }

  function updateScoresForPlayer(playerIdx){
    const tr = document.getElementById(\`player-row-\${playerIdx}\`);
    if (!tr) return;
    const inputs = tr.querySelectorAll('input[data-hole]');
    let out = 0, inn = 0;
    inputs.forEach(inp => {
      const hole = parseInt(inp.dataset.hole);
      const val = parseInt(inp.value) || 0;
      if (hole <= 9) out += val;
      else inn += val;
    });
    document.getElementById(\`out-total-\${playerIdx}\`).textContent = out;
    document.getElementById(\`in-total-\${playerIdx}\`).textContent = inn;
    document.getElementById(\`grand-total-\${playerIdx}\`).textContent = out + inn;
  }

  endGameBtn.addEventListener('click', showWinner);

  function showWinner(){
    const rows = Array.from(scorecardBody.querySelectorAll('tr'));
    const players = rows.map(row => {
      const name = row.querySelector('.player-name').dataset.name;
      const score = parseInt(row.querySelector('[id^="grand-total-"]').textContent) || 0;
      return { name, score };
    });
    players.sort((a,b) => a.score - b.score);
    resultsBody.innerHTML = '';
    players.forEach((p, i) => {
      const tr = document.createElement('tr');
      let nameHtml = p.name;
      if (i === 0) nameHtml += ' <span class="trophy">🏆</span>';
      tr.innerHTML = \`<td class="sticky-col font-bold">\${i+1}</td><td class="text-left font-semibold player-name">\${nameHtml}</td><td class="font-bold">\${p.score}</td>\`;
      resultsBody.appendChild(tr);
    });
    scorecardSection.classList.add('hidden');
    resultsSection.classList.remove('hidden');
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function enableDragScroll(wrapper){
    let isDown = false, startX, startY, scrollLeft, scrollTop;
    wrapper.addEventListener('pointerdown', e => {
      isDown = true;
      wrapper.classList.add('dragging');
      startX = e.clientX;
      startY = e.clientY;
      scrollLeft = wrapper.scrollLeft;
      scrollTop = wrapper.scrollTop;
      wrapper.setPointerCapture(e.pointerId);
    });
    wrapper.addEventListener('pointermove', e => {
      if (!isDown) return;
      wrapper.scrollLeft = scrollLeft - (e.clientX - startX);
      wrapper.scrollTop = scrollTop - (e.clientY - startY);
    });
    wrapper.addEventListener('pointerup', e => {
      isDown = false;
      wrapper.classList.remove('dragging');
      wrapper.releasePointerCapture(e.pointerId);
    });
    wrapper.addEventListener('pointercancel', () => { isDown = false; wrapper.classList.remove('dragging'); });
  }
})();
</script>
</body>
</html>

