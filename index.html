<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarjeta de Puntuación - Villagolf</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .score-input {
            width: 50px;
            height: 40px;
            text-align: center;
            border-radius: 0.5rem;
            border: 1px solid #D1D5DB;
            -moz-appearance: textfield;
        }
        .score-input::-webkit-outer-spin-button,
        .score-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .table-container {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        th, td {
            white-space: nowrap;
            padding: 0.75rem;
        }
        .sticky-col {
            position: -webkit-sticky;
            position: sticky;
            left: 0;
            background-color: white;
            z-index: 10;
        }
        .dark .sticky-col {
            background-color: #1F2937;
        }
        .trophy {
            color: #f59e0b; /* amber-500 */
        }
        .logo-container {
            max-width: 150px; /* Ajusta el tamaño del logo */
            margin: 0 auto;
        }
        .social-logo {
            width: 24px;
            height: 24px;
            fill: currentColor;
            display: inline-block;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-300">

    <div class="container mx-auto p-4 max-w-7xl">
        <header class="text-center mb-6">
            <div class="logo-container mb-4">
                <img src="URL_DE_TU_LOGO.jpg" alt="Logo Villagolf" class="w-full">
            </div>
            <h1 class="text-3xl md:text-4xl font-bold text-teal-600 dark:text-teal-400 uppercase tracking-wider">Tarjeta de Puntuación</h1>
            <p class="text-red-600 dark:text-red-500 mt-2 text-lg font-bold">VILLAGOLF GOLFITO</p>
        </header>

        <div id="setup-section" class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg mb-8">
            <h2 class="text-2xl font-semibold mb-4 text-gray-700 dark:text-gray-300">Configuración del Juego</h2>
            <div id="player-inputs" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                </div>
            <button id="start-game-btn" class="mt-6 w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
                Iniciar Juego
            </button>
        </div>

        <div id="scorecard-section" class="hidden">
            <div class="flex justify-between items-center mb-4 flex-wrap gap-4">
                <h2 class="text-2xl font-semibold text-gray-700 dark:text-gray-300">Tarjeta de Puntuación</h2>
                <button id="reset-game-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-colors">
                    Nuevo Juego
                </button>
            </div>
            <div class="table-container bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                <table class="w-full text-center">
                    <thead id="scorecard-head" class="bg-gray-200 dark:bg-gray-700 text-sm uppercase">
                        </thead>
                    <tbody id="scorecard-body">
                        </tbody>
                </table>
            </div>
            <div id="end-game-container" class="mt-6 text-center">
                <button id="end-game-btn" class="w-full md:w-auto bg-amber-500 hover:bg-amber-600 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500">
                    Finalizar y Ver Ganador
                </button>
            </div>
        </div>

        <div id="results-section" class="hidden bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg mb-8">
            <h2 class="text-2xl font-semibold mb-4 text-center text-gray-700 dark:text-gray-300">Resultados Finales</h2>
            <div class="table-container overflow-hidden">
                <table id="results-table" class="w-full text-center">
                    <thead class="bg-gray-200 dark:bg-gray-700 text-sm uppercase">
                        <tr>
                            <th class="sticky-col font-semibold">Puesto</th>
                            <th class="font-semibold text-left">Jugador</th>
                            <th class="font-semibold">Puntaje</th>
                        </tr>
                    </thead>
                    <tbody id="results-body">
                        </tbody>
                </table>
            </div>
            <div class="mt-6 text-center">
                <button id="email-results-btn" class="w-full md:w-auto bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500">
                    Enviar Resultados por Email
                </button>
            </div>
        </div>
    </div>

    <footer class="bg-gray-200 dark:bg-gray-800 text-center p-4 mt-8 transition-colors duration-300">
        <p class="text-gray-600 dark:text-gray-400 font-bold mb-2">@villagolfmini</p>
        <div class="flex justify-center space-x-4">
            <a href="https://www.instagram.com/villagolfmini" target="_blank" rel="noopener noreferrer" class="text-gray-600 hover:text-pink-500 transition-colors duration-200">
                <svg class="social-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M12 0c-3.879 0-4.372.016-5.882.083-1.509.066-2.54.316-3.447.674-.937.368-1.79.99-2.564 1.764s-1.396 1.627-1.764 2.564c-.358.907-.608 1.938-.674 3.447-.067 1.51-.083 2.003-.083 5.882s.016 4.372.083 5.882c.066 1.509.316 2.54.674 3.447.368.937.99 1.79 1.764 2.564s1.627 1.396 2.564 1.764c.907.358 1.938.608 3.447.674 1.51.067 2.003.083 5.882.083s4.372-.016 5.882-.083c1.509-.066 2.54-.316 3.447-.674.937-.368 1.79-.99 2.564-1.764s1.396-1.627 1.764-2.564c.358-.907.608-1.938.674-3.447.067-1.51.083-2.003.083-5.882s-.016-4.372-.083-5.882c-.066-1.509-.316-2.54-.674-3.447-.368-.937-.99-1.79-1.764-2.564s-1.627-1.396-2.564-1.764c-.907-.358-1.938-.608-3.447-.674-1.51-.067-2.003-.083-5.882-.083zm0 2.164c3.81 0 4.28.014 5.768.08.718.031 1.103.155 1.353.255.45.18.79.404 1.13.743s.563.68.743 1.13c.1.25.224.635.255 1.353.066 1.488.08 1.958.08 5.768s-.014 4.28-.08 5.768c-.031.718-.155 1.103-.255 1.353-.18.45-.404.79-.743 1.13s-.68.563-1.13.743c-.25.1-.635.224-1.353.255-1.488.066-1.958.08-5.768.08s-4.28-.014-5.768-.08c-.718-.031-1.103-.155-1.353-.255-.45-.18-.79-.404-1.13-.743s-.563-.68-.743-1.13c-.1-.25-.224-.635-.255-1.353-.066-1.488-.08-1.958-.08-5.768s.014-4.28.08-5.768c.031-.718.155-1.103.255-1.353.18-.45.404-.79.743-1.13s.68-.563 1.13-.743c.25-.1.635-.224 1.353-.255 1.488-.066 1.958-.08 5.768-.08zM12 6.846c-2.84 0-5.154 2.314-5.154 5.154s2.314 5.154 5.154 5.154 5.154-2.314 5.154-5.154-2.314-5.154-5.154-5.154zm0 8.528c-1.868 0-3.374-1.506-3.374-3.374s1.506-3.374 3.374-3.374 3.374 1.506 3.374 3.374-1.506 3.374-3.374 3.374zm5.836-9.67c-.636 0-1.15-.514-1.15-1.15s.514-1.15 1.15-1.15c.636 0 1.15.514 1.15 1.15s-.514 1.15-1.15 1.15z"/>
                </svg>
            </a>
            <a href="https://www.facebook.com/villagolfmini" target="_blank" rel="noopener noreferrer" class="text-gray-600 hover:text-blue-600 transition-colors duration-200">
                <svg class="social-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.999c0-.879.444-1.001 1.114-1.001h2.886v-3h-3.886c-4.145 0-5.114 3.292-5.114 4.886v2.114z"/>
                </svg>
            </a>
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const playerInputsContainer = document.getElementById('player-inputs');
            const startGameBtn = document.getElementById('start-game-btn');
            const setupSection = document.getElementById('setup-section');
            const scorecardSection = document.getElementById('scorecard-section');
            const scorecardHead = document.getElementById('scorecard-head');
            const scorecardBody = document.getElementById('scorecard-body');
            const resetGameBtn = document.getElementById('reset-game-btn');
            const endGameBtn = document.getElementById('end-game-btn');
            const endGameContainer = document.getElementById('end-game-container');
            const resultsSection = document.getElementById('results-section');
            const resultsBody = document.getElementById('results-body');
            const emailResultsBtn = document.getElementById('email-results-btn');

            // Generate player input fields
            for (let i = 1; i <= 8; i++) {
                const inputDiv = document.createElement('div');
                inputDiv.innerHTML = `
                    <label for="player${i}" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Jugador ${i}</label>
                    <input type="text" id="player${i}" name="player${i}" placeholder="Nombre del Jugador ${i}" class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm">
                `;
                playerInputsContainer.appendChild(inputDiv);
            }

            startGameBtn.addEventListener('click', function() {
                const playerNames = [];
                for (let i = 1; i <= 8; i++) {
                    const input = document.getElementById(`player${i}`);
                    if (input.value.trim() !== '') {
                        playerNames.push(input.value.trim());
                    }
                }

                if (playerNames.length > 0) {
                    setupScorecard(playerNames);
                    setupSection.classList.add('hidden');
                    scorecardSection.classList.remove('hidden');
                    endGameContainer.classList.remove('hidden');
                    endGameBtn.disabled = false;
                } else {
                    showModal('Por favor, ingresa el nombre de al menos un jugador.');
                }
            });

            resetGameBtn.addEventListener('click', function() {
                if(confirm('¿Estás seguro de que quieres empezar un nuevo juego? Se perderán todas las puntuaciones.')) {
                    scorecardSection.classList.add('hidden');
                    endGameContainer.classList.add('hidden');
                    resultsSection.classList.add('hidden');
                    setupSection.classList.remove('hidden');
                    scorecardHead.innerHTML = '';
                    scorecardBody.innerHTML = '';
                    resultsBody.innerHTML = '';
                    // Clear player name inputs
                    for (let i = 1; i <= 8; i++) {
                        document.getElementById(`player${i}`).value = '';
                    }
                }
            });
            
            endGameBtn.addEventListener('click', showWinner);
            emailResultsBtn.addEventListener('click', sendEmail);

            function setupScorecard(players) {
                scorecardHead.innerHTML = '';
                scorecardBody.innerHTML = '';

                const headerRow = document.createElement('tr');
                let headerHTML = '<th class="sticky-col font-semibold">Jugador</th>';
                for (let i = 1; i <= 9; i++) headerHTML += `<th>${i}</th>`;
                headerHTML += '<th class="font-semibold bg-teal-100 dark:bg-teal-800">OUT</th>';
                for (let i = 10; i <= 18; i++) headerHTML += `<th>${i}</th>`;
                headerHTML += '<th class="font-semibold bg-teal-100 dark:bg-teal-800">IN</th>';
                headerHTML += '<th class="font-semibold bg-green-100 dark:bg-green-800">TOTAL</th>';
                headerRow.innerHTML = headerHTML;
                scorecardHead.appendChild(headerRow);
                
                players.forEach((name, index) => {
                    const playerRow = document.createElement('tr');
                    playerRow.id = `player-row-${index}`;
                    playerRow.className = 'border-b border-gray-200 dark:border-gray-700';

                    let rowHTML = `<td class="sticky-col font-bold text-left text-gray-900 bg-white dark:bg-gray-800 dark:text-white" data-name="${name}">${name}</td>`;
                    
                    for (let i = 1; i <= 18; i++) {
                        if (i === 10) {
                            rowHTML += `<td id="out-total-${index}" class="font-bold text-teal-600 dark:text-teal-400 bg-teal-50 dark:bg-teal-900">0</td>`;
                        }
                        rowHTML += `<td><input type="number" min="1" max="8" class="score-input bg-gray-50 dark:bg-gray-700" data-player="${index}" data-hole="${i}"></td>`;
                    }
                    
                    rowHTML += `<td id="in-total-${index}" class="font-bold text-teal-600 dark:text-teal-400 bg-teal-50 dark:bg-teal-900">0</td>`;
                    rowHTML += `<td id="grand-total-${index}" class="font-bold text-xl text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900">0</td>`;

                    playerRow.innerHTML = rowHTML;
                    scorecardBody.appendChild(playerRow);
                });

                document.querySelectorAll('.score-input').forEach(input => {
                    input.addEventListener('input', updateScores);
                });
            }

            function updateScores(event) {
                if (parseInt(event.target.value) > 8) {
                    event.target.value = 8;
                }

                const playerIndex = event.target.dataset.player;
                const playerRow = document.getElementById(`player-row-${playerIndex}`);
                
                let outTotal = 0;
                let inTotal = 0;

                const allInputs = playerRow.querySelectorAll('input[data-hole]');
                allInputs.forEach(input => {
                    const hole = parseInt(input.dataset.hole);
                    const value = parseInt(input.value) || 0;
                    if (hole <= 9) {
                        outTotal += value;
                    } else {
                        inTotal += value;
                    }
                });

                document.getElementById(`out-total-${playerIndex}`).textContent = outTotal;
                document.getElementById(`in-total-${playerIndex}`).textContent = inTotal;
                document.getElementById(`grand-total-${playerIndex}`).textContent = outTotal + inTotal;
            }

            function showWinner() {
                const playerScores = [];
                const rows = scorecardBody.querySelectorAll('tr');

                // Gather scores
                rows.forEach(row => {
                    const nameCell = row.querySelector('td.sticky-col');
                    const name = nameCell.dataset.name;
                    const score = parseInt(row.querySelector('[id^="grand-total-"]').textContent);
                    playerScores.push({ name: name, score: score });
                });

                // Sort players by score (lowest first)
                playerScores.sort((a, b) => a.score - b.score);

                // Disable inputs and buttons
                document.querySelectorAll('.score-input').forEach(input => input.disabled = true);
                endGameBtn.disabled = true;

                // Hide scoreboard and show results
                scorecardSection.classList.add('hidden');
                resultsSection.classList.remove('hidden');

                // Generate and display results
                resultsBody.innerHTML = '';
                const lowestScore = playerScores.length > 0 ? playerScores[0].score : 0;

                playerScores.forEach((player, index) => {
                    const playerRow = document.createElement('tr');
                    playerRow.className = 'border-b border-gray-200 dark:border-gray-700';
                    const position = index + 1;
                    
                    let playerNameHTML = player.name;
                    if (player.score === lowestScore) {
                        // Add trophy icon
                        playerNameHTML += ` <span class="trophy" title="Ganador">&#127942;</span>`;
                    }
                    
                    playerRow.innerHTML = `
                        <td class="sticky-col font-bold text-left text-gray-900 bg-white dark:bg-gray-800 dark:text-white">${position}</td>
                        <td class="font-bold text-left text-gray-900 bg-white dark:bg-gray-800 dark:text-white">${playerNameHTML}</td>
                        <td class="font-bold">${player.score}</td>
                    `;
                    resultsBody.appendChild(playerRow);
                });
            }

            function sendEmail() {
                let subject = encodeURIComponent("Resultados de Minigolf Villagolf");
                let body = "¡Resultados de la partida en Villagolf Golfito!\n\n";

                const resultsRows = resultsBody.querySelectorAll('tr');
                resultsRows.forEach(row => {
                    const position = row.querySelector('td:nth-child(1)').textContent;
                    const name = row.querySelector('td:nth-child(2)').textContent.trim();
                    const score = row.querySelector('td:nth-child(3)').textContent;
                    body += `${position}. ${name}: ${score} puntos\n`;
                });

                body = encodeURIComponent(body);
                window.location.href = `mailto:villagolfmini@gmail.com?subject=${subject}&body=${body}`;
            }

            function showModal(message) {
                const modal = document.createElement('div');
                modal.style.position = 'fixed';
                modal.style.left = '0';
                modal.style.top = '0';
                modal.style.width = '100%';
                modal.style.height = '100%';
                modal.style.backgroundColor = 'rgba(0,0,0,0.5)';
                modal.style.display = 'flex';
                modal.style.justifyContent = 'center';
                modal.style.alignItems = 'center';
                modal.style.zIndex = '1000';
                
                const modalContent = document.createElement('div');
                modalContent.style.backgroundColor = 'white';
                modalContent.style.padding = '20px 40px';
                modalContent.style.borderRadius = '8px';
                modalContent.style.textAlign = 'center';
                
                const text = document.createElement('p');
                text.textContent = message;
                text.style.color = 'black';
                text.style.marginBottom = '20px';
                
                const closeButton = document.createElement('button');
                closeButton.textContent = 'OK';
                closeButton.style.padding = '10px 20px';
                closeButton.style.border = 'none';
                closeButton.style.borderRadius = '5px';
                closeButton.style.backgroundColor = '#10B981'; // Teal-500
                closeButton.style.color = 'white';
                closeButton.style.cursor = 'pointer';

                modalContent.appendChild(text);
                modalContent.appendChild(closeButton);
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
                
                closeButton.onclick = () => {
                    document.body.removeChild(modal);
                };
                 modal.onclick = (event) => {
                    if (event.target === modal) {
                        document.body.removeChild(modal);
                    }
                };
            }
        });
    </script>

</body>
</html>